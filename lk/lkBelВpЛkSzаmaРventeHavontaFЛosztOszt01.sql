SELECT Trim(Replace(Replace(Replace([lkBelépõkUnió].[Fõosztály],"Budapest Fõváros Kormányhivatala","BFKH")," 20200229-ig",""),"Budapest FõvárosKormányhivatala","BFKH")) AS Fõosztály, Replace([lkBelépõkUnió].[Osztály]," 20200229-ig","") AS Osztály, Year([Jogviszony kezdete (belépés dátuma)]) AS Év, Month([Jogviszony kezdete (belépés dátuma)]) AS Hó, Count(tSzemélyek.Azonosító) AS [Belépõk száma]
FROM tSzemélyek RIGHT JOIN lkBelépõkUnió ON (tSzemélyek.[Adóazonosító jel] = lkBelépõkUnió.Adóazonosító) AND (tSzemélyek.[Jogviszony kezdete (belépés dátuma)] = lkBelépõkUnió.[Jogviszony kezdõ dátuma])
WHERE (((tSzemélyek.[KIRA jogviszony jelleg]) Like "Kormányzati*" Or (tSzemélyek.[KIRA jogviszony jelleg])="Munkaviszony") AND ((tSzemélyek.[Jogviszony kezdete (belépés dátuma)]) Is Not Null Or (tSzemélyek.[Jogviszony kezdete (belépés dátuma)])<>""))
GROUP BY Trim(Replace(Replace(Replace([lkBelépõkUnió].[Fõosztály],"Budapest Fõváros Kormányhivatala","BFKH")," 20200229-ig",""),"Budapest FõvárosKormányhivatala","BFKH")), Replace([lkBelépõkUnió].[Osztály]," 20200229-ig",""), Year([Jogviszony kezdete (belépés dátuma)]), Month([Jogviszony kezdete (belépés dátuma)])
HAVING (((Year([Jogviszony kezdete (belépés dátuma)]))>=2019 And (Year([Jogviszony kezdete (belépés dátuma)]))<=Year(Now())+1))
ORDER BY Year([Jogviszony kezdete (belépés dátuma)]), Month([Jogviszony kezdete (belépés dátuma)]);
