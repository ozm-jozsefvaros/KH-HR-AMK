SELECT Bfkh([Szervezetkód]) AS BFKH, lk_Állománytáblákból_Illetmények.Szervezetkód, lk_Állománytáblákból_Illetmények.Adójel, tSzervezet.[Tervezett betöltési adatok - Elõmeneteli fokozat megnevezés] AS besorolás, lk_Állománytáblákból_Illetmények.[Álláshely azonosító], tBesorolás_átalakító_1.[alsó határ], tBesorolás_átalakító_1.[felsõ határ], lk_Állománytáblákból_Illetmények.Illetmény, Besorolás_átalakító.alsó2, Besorolás_átalakító.felsõ2, lk_Állománytáblákból_Illetmények.[Heti munkaórák száma], [Illetmény]/IIf([Heti munkaórák száma]=0,0.0001,[Heti munkaórák száma])*40 AS [40 órás illetmény], tBesorolás_átalakító_1.[Jogviszony típusa], lk_Állománytáblákból_Illetmények.Név, lk_Állománytáblákból_Illetmények.Fõosztály, lk_Állománytáblákból_Illetmények.Osztály
FROM (SELECT [alsó határ] AS alsó2, [felsõ határ] AS felsõ2, Üres, Kit, Mt, [Sorrend]-1 AS EmeltSorrend FROM tBesorolás_átalakító)  AS Besorolás_átalakító RIGHT JOIN (tBesorolás_átalakító AS tBesorolás_átalakító_1 RIGHT JOIN (lk_Állománytáblákból_Illetmények RIGHT JOIN tSzervezet ON lk_Állománytáblákból_Illetmények.[Álláshely azonosító]=tSzervezet.[Szervezetmenedzsment kód]) ON tBesorolás_átalakító_1.[Az álláshely jelölése]=lk_Állománytáblákból_Illetmények.BesorolásHavi) ON (Besorolás_átalakító.EmeltSorrend=tBesorolás_átalakító_1.Sorrend) AND (Besorolás_átalakító.Mt=tBesorolás_átalakító_1.Mt) AND (Besorolás_átalakító.Kit=tBesorolás_átalakító_1.Kit) AND (Besorolás_átalakító.Üres=tBesorolás_átalakító_1.Üres)
WHERE ((([Illetmény]/IIf([Heti munkaórák száma]=0,0.0001,[Heti munkaórák száma])*40) Not Between [alsó határ] And [felsõ határ])) OR ((([Illetmény]/IIf([Heti munkaórák száma]=0,0.0001,[Heti munkaórák száma])*40) Not Between [alsó2] And [felsõ2]));
