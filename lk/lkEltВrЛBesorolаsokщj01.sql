SELECT DISTINCT lkSzemélyek.Adójel, lkSzemélyek.[Dolgozó teljes neve] AS Név, lkSzemélyek.Fõosztály, lkSzemélyek.Osztály, lkSzervezetiÁlláshelyek.[Tervezett betöltési adatok - Elõmeneteli fokozat megnevezés] AS [Szervezeti struktúra], lkBesorolásVáltoztatások.ÚjBesorolás, lkSzemélyek.Besorolás AS [Személyi karton], lkSzemélyek.[Jogviszony típusa / jogviszony típus], lkSzemélyek.[Tartós távollét típusa], lkSzervezetiÁlláshelyek.ÁlláshelyAzonosító AS [Álláshely azonosító], kt_azNexon_Adójel02.NLink, bfkh([SzervezetKód]) AS BFKH, IIf([Besorolás]<>[ÚjBesorolás],"Az eltérés oka: az új besoroltatás még nincs rögzítve a Nexon-ban.","") AS Megjegyzés
FROM lkBesorolásVáltoztatások RIGHT JOIN (kt_azNexon_Adójel02 RIGHT JOIN (lkSzervezetiÁlláshelyek LEFT JOIN lkSzemélyek ON lkSzervezetiÁlláshelyek.ÁlláshelyAzonosító = lkSzemélyek.[Státusz kódja]) ON kt_azNexon_Adójel02.Adójel = lkSzemélyek.Adójel) ON lkBesorolásVáltoztatások.ÁlláshelyAzonosító = lkSzervezetiÁlláshelyek.ÁlláshelyAzonosító
WHERE (((lkSzervezetiÁlláshelyek.[Tervezett betöltési adatok - Elõmeneteli fokozat megnevezés])<>[Besorolás]) AND ((lkSzemélyek.[Jogviszony típusa / jogviszony típus])<>"Munkaviszony"));
