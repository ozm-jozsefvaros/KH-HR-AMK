SELECT lkSzemélyek.[Adóazonosító jel], bfkh(Nz([Szervezeti egység kódja],"-")) AS BFKH, lkSzemélyek.[Dolgozó teljes neve], lkSzemélyek.Fõosztály, lkSzemélyek.Osztály, lkSzemélyek.Besorolás2, LCase(Replace(Nz([Besorolási  fokozat (KT)],""),"Járási / ","")) & IIf(Nz([Tartós távollét típusa],"")<>""," (TT)","") AS [Ellátott feladat], lkSzemélyek.[Születési hely], lkSzemélyek.[Születési idõ], lkSzemélyek.[Anyja neve], lkSzemélyek.[Állandó lakcím], lkSzemélyek.[Tartózkodási lakcím]
FROM lkSzemélyek
WHERE (((LCase(Replace(Nz([Besorolási  fokozat (KT)],""),"Járási / ","")) & IIf(Nz([Tartós távollét típusa],"")<>""," (TT)",""))="osztályvezetõ") AND ((lkSzemélyek.[Szervezeti egység kódja]) Is Not Null)) OR (((LCase(Replace(Nz([Besorolási  fokozat (KT)],""),"Járási / ","")) & IIf(Nz([Tartós távollét típusa],"")<>""," (TT)","")) Like "kerületi*") AND ((lkSzemélyek.[Szervezeti egység kódja]) Is Not Null)) OR (((LCase(Replace(Nz([Besorolási  fokozat (KT)],""),"Járási / ","")) & IIf(Nz([Tartós távollét típusa],"")<>""," (TT)","")) Like "fõosztály*") AND ((lkSzemélyek.[Szervezeti egység kódja]) Is Not Null)) OR (((LCase(Replace(Nz([Besorolási  fokozat (KT)],""),"Járási / ","")) & IIf(Nz([Tartós távollét típusa],"")<>""," (TT)","")) Like "*igazgató*") AND ((lkSzemélyek.[Szervezeti egység kódja]) Is Not Null)) OR (((LCase(Replace(Nz([Besorolási  fokozat (KT)],""),"Járási / ","")) & IIf(Nz([Tartós távollét típusa],"")<>""," (TT)",""))="fõispán") AND ((lkSzemélyek.[Szervezeti egység kódja]) Is Not Null))
ORDER BY bfkh(Nz([Szervezeti egység kódja],"-")), LCase(Replace(Nz([Besorolási  fokozat (KT)],""),"Járási / ","")) & IIf(Nz([Tartós távollét típusa],"")<>""," (TT)","");
