SELECT lkSzemélyek.[Dolgozó teljes neve], lkSzemélyek.[Születési idõ], DateSerial(Year(Nz([Születési idõ],#1/1/1900#))+65,Month(Nz([Születési idõ],#1/1/1900#)),Day(Nz([Születési idõ],#1/1/1900#))) AS [65_ életévét betölti], DateSerial(Year(Nz([Születési idõ],#1/1/1900#))+58,Month(Nz([Születési idõ],#1/1/1900#)),Day(Nz([Születési idõ],#1/1/1900#))) AS [58_ életévét betölti], lkSzemélyek.Fõosztály, lkSzemélyek.Osztály, lkSzemélyek.Besorolás2 AS Besorolás, lkSzemélyek.[Jogviszony típusa / jogviszony típus] AS Jogviszony, lkSzemélyek.Neme, Year(Date())-ffsplit(Nz([Szolgálati elismerésre jogosultság / Jubileumi jutalom kezdõ dát],Year(Date())),".",1)*1 AS [Szolgálati évek]
FROM lkSzemélyek LEFT JOIN lkSzolgálatiIdõElismerés ON lkSzemélyek.Adójel=lkSzolgálatiIdõElismerés.Adójel
WHERE (((DateSerial(Year(Nz([Születési idõ],#1/1/1900#))+58,Month(Nz([Születési idõ],#1/1/1900#)),Day(Nz([Születési idõ],#1/1/1900#)))) Between Date() And DateAdd("m",18,Date())) AND ((lkSzemélyek.Neme)="nõ") AND ((lkSzemélyek.[Státusz neve])="álláshely") AND (("Keressük azokat a nõket, akik az 58. születésnapjukat a következõ 18 hónapban töltik be.")=True)) OR (((DateSerial(Year(Nz([Születési idõ],#1/1/1900#))+65,Month(Nz([Születési idõ],#1/1/1900#)),Day(Nz([Születési idõ],#1/1/1900#))))>Date()) AND ((DateSerial(Year(Nz([Születési idõ],#1/1/1900#))+58,Month(Nz([Születési idõ],#1/1/1900#)),Day(Nz([Születési idõ],#1/1/1900#))))<Date()) AND ((lkSzemélyek.Neme)="nõ") AND ((lkSzemélyek.[Státusz neve])="álláshely") AND (("Keressük azokat a nõket, akik még nem töltötték be a 65. életévüket, de az 58. már igen.")=True))
ORDER BY Year([Születési idõ])+58, Month([Születési idõ]);
