SELECT Month([Jogviszony kezdete (belépés dátuma)]) AS [Belépés hónapja], IIf([Orvosi vizsgálat következõ idõpontja]<DateAdd("m",1,DateSerial(Year(Now()),Month(Now()),1))-1,"Lejáró","") AS Lejárók, lkSzemélyek.[Dolgozó teljes neve], lkSzemélyek.[TAJ szám], lkSzemélyek.[Hivatali email], lkSzemélyek.[Hivatali mobil], lkSzemélyek.[Születési idõ], lkSzemélyek.[Születési hely], lkSzemélyek.[Anyja neve], lkSzemélyek.Neme, lkSzemélyek.[Állandó lakcím], lkSzemélyek.[Szervezeti egység neve], lkSzemélyek.[Orvosi vizsgálat idõpontja], lkSzemélyek.[Orvosi vizsgálat típusa], lkSzemélyek.[Orvosi vizsgálat eredménye], lkSzemélyek.[Orvosi vizsgálat észrevételek], lkSzemélyek.[Orvosi vizsgálat következõ idõpontja], lkSzemélyek.[Tartós távollét típusa]
FROM lkSzemélyek
GROUP BY Month([Jogviszony kezdete (belépés dátuma)]), IIf([Orvosi vizsgálat következõ idõpontja]<DateAdd("m",1,DateSerial(Year(Now()),Month(Now()),1))-1,"Lejáró",""), lkSzemélyek.[Dolgozó teljes neve], lkSzemélyek.[TAJ szám], lkSzemélyek.[Hivatali email], lkSzemélyek.[Hivatali mobil], lkSzemélyek.[Születési idõ], lkSzemélyek.[Születési hely], lkSzemélyek.[Anyja neve], lkSzemélyek.Neme, lkSzemélyek.[Állandó lakcím], lkSzemélyek.[Szervezeti egység neve], lkSzemélyek.[Orvosi vizsgálat idõpontja], lkSzemélyek.[Orvosi vizsgálat típusa], lkSzemélyek.[Orvosi vizsgálat eredménye], lkSzemélyek.[Orvosi vizsgálat észrevételek], lkSzemélyek.[Orvosi vizsgálat következõ idõpontja], lkSzemélyek.[Tartós távollét típusa]
HAVING (((lkSzemélyek.[Szervezeti egység neve]) Like "*humán*"));
