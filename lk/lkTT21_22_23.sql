SELECT TT21_22_23.Fõosztály, TT21_22_23.Osztály, Sum(TT21_22_23.TTLétszám2021) AS SumOfTTLétszám2021, Sum(TT21_22_23.TTLétszám2022) AS SumOfTTLétszám2022, Sum(TT21_22_23.TTLétszám2023) AS SumOfTTLétszám2023, Sum(TT21_22_23.Létszám2023) AS SumOfLétszám2023
FROM (SELECT lkTTLétszámFõosztályonkéntOsztályonként2021.Fõosztály, lkTTLétszámFõosztályonkéntOsztályonként2021.Osztály, lkTTLétszámFõosztályonkéntOsztályonként2021.TTLétszám2021, lkTTLétszámFõosztályonkéntOsztályonként2021.TTLétszám2022, lkTTLétszámFõosztályonkéntOsztályonként2021.TTLétszám2023, 0 as Létszám2023
FROM lkTTLétszámFõosztályonkéntOsztályonként2021
UNION
SELECT
lkTTLétszámFõosztályonkéntOsztályonként2022.Fõosztály, lkTTLétszámFõosztályonkéntOsztályonként2022.Osztály, lkTTLétszámFõosztályonkéntOsztályonként2022.TTLétszám2021, lkTTLétszámFõosztályonkéntOsztályonként2022.TTLétszám2022, lkTTLétszámFõosztályonkéntOsztályonként2022.TTLétszám2023, 0 as Létszám2023
FROM lkTTLétszámFõosztályonkéntOsztályonként2022
UNION
SELECT lkTTLétszámFõosztályonkéntOsztályonként2023.Fõosztály, lkTTLétszámFõosztályonkéntOsztályonként2023.Osztály, lkTTLétszámFõosztályonkéntOsztályonként2023.TTLétszám2021, lkTTLétszámFõosztályonkéntOsztályonként2023.TTLétszám2022, lkTTLétszámFõosztályonkéntOsztályonként2023.TTLétszám2023, 0 as Létszám2023
FROM lkTTLétszámFõosztályonkéntOsztályonként2023
UNION
SELECT lkLétszámFõosztályonkéntOsztályonként20230101.Fõosztály, lkLétszámFõosztályonkéntOsztályonként20230101.Osztály, lkLétszámFõosztályonkéntOsztályonként20230101.TTLétszám2021, lkLétszámFõosztályonkéntOsztályonként20230101.TTLétszám2022, 0 as TTLétszám2023, SumOfLétszám2023
FROM lkLétszámFõosztályonkéntOsztályonként20230101)  AS TT21_22_23
GROUP BY TT21_22_23.Fõosztály, TT21_22_23.Osztály;
