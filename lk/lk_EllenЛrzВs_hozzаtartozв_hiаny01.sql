SELECT Nz([lkHozzátartozók].[Szervezeti egység kódja],[ÁNYR SZERVEZETI EGYSÉG AZONOSÍTÓ]) AS SzervezetKód, lkHozzátartozók.[Dolgozó neve], lkHozzátartozók.Adójel AS [Dolgozó adóazonosító jele], lkHozzátartozók.[Hozzátartozó neve], lkHozzátartozók.[Hozzátartozó adóazonosító jele], lkHozzátartozók.[Születési hely], Trim([Anyja családi neve] & " " & [Anyja utóneve]) AS [Anyja neve], lkHozzátartozók.[Születési idõ], Trim(Replace(Nz([lkHozzátartozók].[Állandó lakcím],""),"Magyarország","")) AS GyermekÁllandó, Trim(Replace(Nz([lkHozzátartozók].[Tartózkodási lakcím],""),"Magyarország","")) AS GyermekTartózkodási, Replace(Nz([lkSzemélyek].[Állandó lakcím],""),"Magyarország, ","") AS SzülõÁllandó, Replace(Nz([lkszemélyek].[Tartózkodási lakcím],""),"Magyarország, ","") AS SzülõTartózkodási, lkKilépõk.[Jogviszony megszûnésének, megszüntetésének idõpontja], lkHozzátartozók.[Hozzátartozó TAJ száma]
FROM (lkHozzátartozók LEFT JOIN lkSzemélyek ON lkHozzátartozók.Adójel = lkSzemélyek.Adójel) LEFT JOIN lkKilépõk ON lkHozzátartozók.Adójel = lkKilépõk.Adójel
WHERE (((lkHozzátartozók.[Születési idõ])>DateSerial(Year(Date())-18,1,1)) AND ((lkKilépõk.[Jogviszony megszûnésének, megszüntetésének idõpontja])>DateSerial(Year(Date()),1,1) Or (lkKilépõk.[Jogviszony megszûnésének, megszüntetésének idõpontja]) Is Null) AND ((lkHozzátartozók.[Otthoni e-mail cím]) Not Like "elhunyt*") AND ((Nz([tHozzátartozók].[Szervezeti egység kódja],[ÁNYR SZERVEZETI EGYSÉG AZONOSÍTÓ])) Is Not Null) AND ((lkSzemélyek.[Státusz típusa]) Like "Központosított állomány" Or (lkSzemélyek.[Státusz típusa]) Like "Szervezeti*") AND ((lkHozzátartozók.[Kapcsolat jellege])="Gyermek") AND ((lkSzemélyek.[Státusz neve])="Álláshely")) OR (((lkHozzátartozók.[Születési idõ])>DateSerial(Year(Date())-18,1,1)) AND ((lkKilépõk.[Jogviszony megszûnésének, megszüntetésének idõpontja])>DateSerial(Year(Date()),1,1) Or (lkKilépõk.[Jogviszony megszûnésének, megszüntetésének idõpontja]) Is Null) AND ((lkHozzátartozók.[Otthoni e-mail cím]) Is Null) AND ((Nz([tHozzátartozók].[Szervezeti egység kódja],[ÁNYR SZERVEZETI EGYSÉG AZONOSÍTÓ])) Is Not Null) AND ((lkSzemélyek.[Státusz típusa]) Like "Központosított állomány" Or (lkSzemélyek.[Státusz típusa]) Like "Szervezeti*") AND ((lkHozzátartozók.[Kapcsolat jellege])="Gyermek") AND ((lkSzemélyek.[Státusz neve])="Álláshely")) OR (((lkHozzátartozók.[Születési idõ])>DateSerial(Year(Date())-18,1,1)) AND ((lkKilépõk.[Jogviszony megszûnésének, megszüntetésének idõpontja])>DateSerial(Year(Date()),1,1) Or (lkKilépõk.[Jogviszony megszûnésének, megszüntetésének idõpontja]) Is Null) AND ((lkHozzátartozók.[Otthoni e-mail cím]) Not Like "elhunyt*") AND ((Nz([tHozzátartozók].[Szervezeti egység kódja],[ÁNYR SZERVEZETI EGYSÉG AZONOSÍTÓ])) Is Not Null) AND ((lkSzemélyek.[Státusz típusa]) Is Null) AND ((lkHozzátartozók.[Kapcsolat jellege])="Gyermek") AND ((lkSzemélyek.[Státusz neve])="Álláshely")) OR (((lkHozzátartozók.[Születési idõ])>DateSerial(Year(Date())-18,1,1)) AND ((lkKilépõk.[Jogviszony megszûnésének, megszüntetésének idõpontja])>DateSerial(Year(Date()),1,1) Or (lkKilépõk.[Jogviszony megszûnésének, megszüntetésének idõpontja]) Is Null) AND ((lkHozzátartozók.[Otthoni e-mail cím]) Is Null) AND ((Nz([tHozzátartozók].[Szervezeti egység kódja],[ÁNYR SZERVEZETI EGYSÉG AZONOSÍTÓ])) Is Not Null) AND ((lkSzemélyek.[Státusz típusa]) Is Null) AND ((lkHozzátartozók.[Kapcsolat jellege])="Gyermek") AND ((lkSzemélyek.[Státusz neve])="Álláshely"))
ORDER BY lkHozzátartozók.[Születési idõ];
