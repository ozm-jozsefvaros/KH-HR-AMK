SELECT lkSzemélyek_1.[Dolgozó teljes neve] AS [Helyettesített neve], lkSzemélyek_1.Adójel AS [Helyettesített adójele], "A" AS Alaplétszám, Replace(Replace(IIf(InStr(1,[lkSzemélyek_1].[Szint 4 szervezeti egység név],"Budapest"),[lkSzemélyek_1].[Szint 4 szervezeti egység név],"Megyei"),"Budapest Fõváros Kormányhivatala","BFKH"),"  ","") AS Megyei_TT, Replace(Replace(IIf(InStr(1,[lkSzemélyek_1].[Szint 5 szervezeti egység név],"Budapest"),[lkSzemélyek_1].[Szint 5 szervezeti egység név],[lkSzemélyek_1].[Szint 4 szervezeti egység név]),"Budapest Fõváros Kormányhivatala","BFKH"),"  ","") AS Fõoszt_TT, lkSzemélyek_1.[Szint 5 szervezeti egység név], lkSzemélyek_1.[Szervezeti egység kódja] AS [Helyettesített szervezete], lkSzemélyek_1.[KIRA feladat megnevezés], lkSzemélyek_1.[Státusz kódja] AS [Helyettesített álláshelye], lkSzemélyek_1.[Tartós távollét típusa], lkSzemélyek_1.[Tartós távollét kezdete], lkSzemélyek_1.[Tartós távollét vége], lkSzemélyek_1.[Tartós távollét tervezett vége], lkSzemélyek.[Dolgozó teljes neve] AS [Helyettes neve], lkSzemélyek.Adójel AS [Helyettes adójele], "A" AS [Helyettes alaplétszám], lkSzemélyek.[Szervezeti egység kódja] AS [Helyettes szervezete], lkSzemélyek.[Státusz kódja] AS [Helyettes álláshelye], Replace(Replace(IIf(InStr(1,[lkSzemélyek].[Szint 4 szervezeti egység név],"Budapest"),[lkSzemélyek].[Szint 4 szervezeti egység név],"Megyei"),"Budapest Fõváros Kormányhivatala","BFKH"),"  ","") AS Megyei_TTH, Replace(Replace(IIf(InStr(1,[lkSzemélyek].[Szint 5 szervezeti egység név],"Budapest"),[lkSzemélyek].[Szint 5 szervezeti egység név],[lkSzemélyek].[Szint 4 szervezeti egység név]),"Budapest Fõváros Kormányhivatala","BFKH"),"  ","") AS Fõoszt_TTH, lkSzemélyek.[Szint 5 szervezeti egység név], lkSzemélyek.[Szervezeti egység kódja] AS [Helyettesítõ szervezete], lkSzemélyek.[KIRA feladat megnevezés], lkSzemélyek.[Státusz kódja] AS Álláshely_TTH, lkSzemélyek.[Jogviszony kezdete (belépés dátuma)], lkSzemélyek.[Jogviszony vége (kilépés dátuma)], lkSzemélyek.[Kerekített 100 %-os illetmény (eltérített)] AS Illetmény_TTH
FROM lkSzemélyek RIGHT JOIN lkSzemélyek AS lkSzemélyek_1 ON lkSzemélyek.[Helyettesített dolgozó neve]=lkSzemélyek_1.[Dolgozó teljes neve]
WHERE (((lkSzemélyek_1.[Tartós távollét típusa]) Is Not Null) And ((IIf(lkSzemélyek.[Helyettesített dolgozó neve]<>"",1,0))=1)) Or (((lkSzemélyek_1.[Tartós távollét típusa]) Not Like "") And ((IIf(lkSzemélyek.[Helyettesített dolgozó neve]<>"",1,0))=1));
