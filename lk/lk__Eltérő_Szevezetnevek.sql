SELECT lkSzemélyek.[Szervezeti egység kódja], lkÁlláshelyek.Fõosztály AS Fõosztály_ÁNYR, lkÁlláshelyek.[5 szint] AS Osztály_ÁNYR, Replace(IIf(IsNull([lkSzemélyek].[Szint 4 szervezeti egység név]),[lkSzemélyek].[Szint 3 szervezeti egység név] & "",[lkSzemélyek].[Szint 4 szervezeti egység név] & ""),"Budapest Fõváros Kormányhivatala ","BFKH ") AS Fõosztály_Nexon_SzemélyKarton, lkSzemélyek.[Szint 5 szervezeti egység név] AS Osztály_Nexon_SzemélyKarton, lkÁlláshelyek.[Álláshely azonosító], lkSzemélyek.[Dolgozó teljes neve]
FROM lkÁlláshelyek INNER JOIN (lkSzemélyek LEFT JOIN tSzervezet ON lkSzemélyek.[Státusz kódja] = tSzervezet.[Szervezetmenedzsment kód]) ON lkÁlláshelyek.[Álláshely azonosító] = lkSzemélyek.[Státusz kódja]
WHERE (((lkSzemélyek.[Szervezeti egység kódja]) Is Not Null) AND ((lkÁlláshelyek.[5 szint])<>[Szint 5 szervezeti egység név])) OR (((lkSzemélyek.[Szervezeti egység kódja]) Is Not Null) AND ((Replace(IIf(IsNull([lkSzemélyek].[Szint 4 szervezeti egység név]),[lkSzemélyek].[Szint 3 szervezeti egység név] & "",[lkSzemélyek].[Szint 4 szervezeti egység név] & ""),"Budapest Fõváros Kormányhivatala ","BFKH "))<>[lkÁlláshelyek].[Fõosztály]));
