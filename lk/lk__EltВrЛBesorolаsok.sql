SELECT DISTINCT lkSzervezetÁlláshelyek.SzervezetKód, lkSzemélyek.[Dolgozó teljes neve], lkSzemélyek.[Tartós távollét típusa], lkSzemélyek.[Helyettesített dolgozó neve], Replace([lkSzemélyek].[Fõosztály],"Budapest Fõváros Kormányhivatala ","BFKH ") AS Fõosztály, lkSzervezetÁlláshelyek.Álláshely AS Álláshely, Álláshelyek.[Álláshely besorolási kategóriája] AS ÁNYR, lkSzemélyek.Besorolás AS [Személyi karton], lkSzervezetÁlláshelyek.[Tervezett betöltési adatok - Elõmeneteli fokozat megnevezés] AS [Szervezeti struktúra], "https://nexonport.kh.gov.hu/menu/hrm/szemelyiKarton/index?szemelyAzonosito=" & [azNexon] & "&r=13" AS Link, IIf(UCase$(Nz([Álláshely besorolási kategóriája],""))=UCase$(Nz([Tervezett betöltési adatok - Elõmeneteli fokozat megnevezés],"")),True,False) AS Ányr_vs_Szervezeti, IIf(Nz([Tervezett betöltési adatok - Elõmeneteli fokozat megnevezés],"")=Nz([lkSzemélyek].[Besorolás],""),True,False) AS Szervezeti_vs_Személyi, IIf(UCase$(Nz([Álláshely besorolási kategóriája],""))=UCase$(Nz([lkSzemélyek].[Besorolás],"")),True,False) AS Ány_vs_Személyi, lkSzervezetÁlláshelyek.Betöltött, kt_azNexon_Adójel.azNexon, lkSzemélyek.adójel
FROM (kt_azNexon_Adójel RIGHT JOIN (lkSzervezetÁlláshelyek LEFT JOIN lkSzemélyek ON lkSzervezetÁlláshelyek.Álláshely = lkSzemélyek.[Státusz kódja]) ON kt_azNexon_Adójel.Adójel = lkSzemélyek.Adójel) LEFT JOIN Álláshelyek ON lkSzervezetÁlláshelyek.Álláshely = Álláshelyek.[Álláshely azonosító]
WHERE (((IIf(UCase$(Nz([Álláshely besorolási kategóriája],""))=UCase$(Nz([Tervezett betöltési adatok - Elõmeneteli fokozat megnevezés],"")),True,False))=False) And ((lkSzemélyek.[Jogviszony típusa / jogviszony típus]) Like "Munka*")) Or (((IIf(Nz([Tervezett betöltési adatok - Elõmeneteli fokozat megnevezés],"")=Nz(lkSzemélyek.Besorolás,""),True,False))=False) And ((lkSzemélyek.[Jogviszony típusa / jogviszony típus]) Not Like "Munka*")) Or (((IIf(UCase$(Nz([Álláshely besorolási kategóriája],""))=UCase$(Nz([Tervezett betöltési adatok - Elõmeneteli fokozat megnevezés],"")),True,False))=False) And ((lkSzemélyek.[Jogviszony típusa / jogviszony típus]) Not Like "Munka*")) Or (((IIf(UCase$(Nz([Álláshely besorolási kategóriája],""))=UCase$(Nz(lkSzemélyek.Besorolás,"")),True,False))=False) And ((lkSzemélyek.[Jogviszony típusa / jogviszony típus]) Not Like "Munka*")) Or (((IIf(UCase$(Nz([Álláshely besorolási kategóriája],""))=UCase$(Nz([Tervezett betöltési adatok - Elõmeneteli fokozat megnevezés],"")),True,False))=False) And ((lkSzemélyek.[Jogviszony típusa / jogviszony típus]) Is Null))
ORDER BY lkSzemélyek.[Dolgozó teljes neve];
