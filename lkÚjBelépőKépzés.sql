SELECT (Select count(Tmp.Azonosító) From lkSzemélyek as Tmp Where Tmp.[Jogviszony típusa / jogviszony típus]<=lkSzemélyek.[Jogviszony típusa / jogviszony típus] and Tmp.[Jogviszony kezdete (belépés dátuma)]<=lkSzemélyek.[Jogviszony kezdete (belépés dátuma)] And Tmp.[Dolgozó teljes neve]<=lkSzemélyek.[Dolgozó teljes neve]) AS Sorszám, lkSzemélyek.[Jogviszony típusa / jogviszony típus] AS Jogviszony, lkSzemélyek.[Jogviszony kezdete (belépés dátuma)] AS Belépés, lkSzemélyek.[Dolgozó teljes neve] AS Név, lkSzemélyek.Fõosztály, lkSzemélyek.[Hivatali email] AS [E-mail cím], lkSzemélyek.Adójel AS [Adóazonosító jel], [Születési hely] & ", " & [Születési idõ] AS [Születési hely dátum], lkSzemélyek.[Anyja neve], lkSzemélyek.[TAJ szám], lkKilépõk.[Jogviszony megszûnésének, megszüntetésének idõpontja], lkSzemélyek.[Jogviszony vége (kilépés dátuma)] AS Kilépés, lkSzemélyek.[Jogfolytonos idõ kezdete], lkSzemélyek.[Szerzõdés/Kinevezés - próbaidõ vége], lkSzemélyek.Nyugdíjas, lkSzemélyek.[Nyugdíj típusa], lkSzemélyek.[Nyugdíjas korú továbbfoglalkoztatási engedéllyel rendelkezik]
FROM lkKilépõk RIGHT JOIN lkSzemélyek ON lkKilépõk.Adóazonosító = lkSzemélyek.[Adóazonosító jel]
WHERE (((lkSzemélyek.[Jogviszony típusa / jogviszony típus])="Kormányzati szolgálati jogviszony" Or (lkSzemélyek.[Jogviszony típusa / jogviszony típus])="Munkaviszony") AND ((lkSzemélyek.[Jogviszony kezdete (belépés dátuma)])>=#11/1/2022#) AND ((lkSzemélyek.[Jogviszony vége (kilépés dátuma)])>=#5/15/2023# Or (lkSzemélyek.[Jogviszony vége (kilépés dátuma)]) Is Null))
ORDER BY lkSzemélyek.[Jogviszony típusa / jogviszony típus], lkSzemélyek.[Jogviszony kezdete (belépés dátuma)], lkSzemélyek.[Dolgozó teljes neve];
